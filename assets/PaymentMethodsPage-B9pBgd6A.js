import{d as F,z as j,C,w as c,i as A,k as o,b as s,m as n,c as r,s as f,r as K,F as y,p as L,v as q,I as P,f as d,x as v,_,t as I,l as U,q as H,j as k,J}from"./index-BYtlHEAg.js";import{t as R,o as Y,s as G,u as O,a as Q}from"./vee-validate-zod-DMy80Ona.js";import{e as w}from"./index-DGW2OPUm.js";import{_ as W}from"./AppShell.vue_vue_type_script_setup_true_lang-CLwHBfE0.js";import{_ as X,a as S}from"./AppIconButton.vue_vue_type_script_setup_true_lang-DQlAomsS.js";import{_ as Z}from"./AppInput.vue_vue_type_script_setup_true_lang-Bw9j5WbD.js";const ee={class:"max-w-6xl"},te={class:"space-y-6 lg:grid lg:grid-cols-[1fr_360px] lg:gap-8 lg:space-y-0 lg:items-start"},se={class:"space-y-6"},ae={class:"bg-white rounded-xl border border-surface-100 shadow-sm divide-y divide-surface-50"},oe={key:0,class:"px-5 py-10 text-center text-sm text-surface-400"},ne={key:0,class:"text-surface-300 shrink-0",title:"System (read-only)"},re=["onKeydown"],ie={class:"flex-1 text-sm text-surface-800"},le={class:"lg:sticky lg:top-6"},de={class:"bg-white rounded-xl border border-surface-100 shadow-sm p-5"},ge=F({__name:"PaymentMethodsPage",setup(me){const m=j(),{confirm:$}=J(),i=A(),p=k(null),l=k(""),g=k(!1);function D(a){p.value=a.id,l.value=a.name}function x(){p.value=null,l.value=""}async function b(a){if(l.value.trim()){g.value=!0;try{await m.updatePaymentMethod(a.id,{name:l.value.trim()}),i.success("Payment method updated"),x()}catch(e){i.error(w(e))}finally{g.value=!1}}}async function N(a){if(await $({title:"Delete Payment Method",message:`Delete "${a.name}"? This may affect existing transactions.`,confirmLabel:"Delete",danger:!0}))try{await m.deletePaymentMethod(a.id),i.success("Payment method deleted")}catch(t){i.error(w(t))}}const V=R(Y({name:G().min(1,"Name is required").max(50)})),{handleSubmit:E,isSubmitting:T,resetForm:z}=O({validationSchema:V}),{value:h,errorMessage:B}=Q("name"),M=E(async a=>{try{await m.createPaymentMethod({name:a.name}),i.success("Payment method created"),z()}catch(e){i.error(w(e))}});return(a,e)=>(o(),C(W,null,{default:c(()=>[s("div",ee,[s("div",te,[s("div",se,[e[7]||(e[7]=s("div",null,[s("h2",{class:"text-base font-semibold text-surface-900"},"Payment Methods"),s("p",{class:"text-xs text-surface-400 mt-0.5"}," System payment methods are read-only. You can add and manage your own. ")],-1)),s("div",ae,[n(m).paymentMethods.length===0?(o(),r("div",oe," No payment methods yet. ")):f("",!0),(o(!0),r(y,null,K(n(m).paymentMethods,t=>(o(),r("div",{key:t.id,class:"flex items-center gap-3 px-4 py-3"},[t.is_default?(o(),r("span",ne,[...e[3]||(e[3]=[s("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.8"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)])])):f("",!0),p.value===t.id?(o(),r(y,{key:1},[L(s("input",{"onUpdate:modelValue":e[0]||(e[0]=u=>l.value=u),class:"flex-1 rounded-lg border border-primary-400 px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",onKeydown:[P(u=>b(t),["enter"]),P(x,["escape"])]},null,40,re),[[q,l.value]]),d(_,{size:"sm",loading:g.value,onClick:u=>b(t)},{default:c(()=>[...e[4]||(e[4]=[v("Save",-1)])]),_:1},8,["loading","onClick"]),d(_,{size:"sm",variant:"ghost",onClick:x},{default:c(()=>[...e[5]||(e[5]=[v("Cancel",-1)])]),_:1})],64)):(o(),r(y,{key:2},[s("span",ie,I(t.name),1),t.is_default?(o(),C(X,{key:0,variant:"system",size:"sm"},{default:c(()=>[...e[6]||(e[6]=[v("System",-1)])]),_:1})):f("",!0),t.is_default?f("",!0):(o(),r(y,{key:1},[d(S,{icon:"edit",title:"Edit",onClick:u=>D(t)},null,8,["onClick"]),d(S,{icon:"delete",title:"Delete",onClick:u=>N(t)},null,8,["onClick"])],64))],64))]))),128))])]),s("div",le,[s("div",de,[e[9]||(e[9]=s("h3",{class:"text-sm font-semibold text-surface-700 mb-3"},"Add Payment Method",-1)),s("form",{class:"space-y-3",onSubmit:e[2]||(e[2]=U((...t)=>n(M)&&n(M)(...t),["prevent"]))},[d(Z,{modelValue:n(h),"onUpdate:modelValue":e[1]||(e[1]=t=>H(h)?h.value=t:null),placeholder:"e.g. PayPal, Crypto",error:n(B)},null,8,["modelValue","error"]),d(_,{class:"w-full",type:"submit",loading:n(T)},{default:c(()=>[...e[8]||(e[8]=[v("Add Method",-1)])]),_:1},8,["loading"])],32)])])])])]),_:1}))}});export{ge as default};
