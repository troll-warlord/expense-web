import{d as q,z as U,C as D,w as u,i as H,j as x,k as o,b as t,c as n,r as E,y as J,t as m,F as f,s as p,p as P,v as R,I as N,f as r,x as y,_ as w,n as Y,l as G,m as g,q as O,E as Q,J as W}from"./index-BYtlHEAg.js";import{t as X,o as Z,s as ee,u as se,a as te}from"./vee-validate-zod-DMy80Ona.js";import{e as b}from"./index-DGW2OPUm.js";import{_ as ae}from"./AppShell.vue_vue_type_script_setup_true_lang-CLwHBfE0.js";import{_ as V,a as T}from"./AppIconButton.vue_vue_type_script_setup_true_lang-DQlAomsS.js";import{_ as oe}from"./AppInput.vue_vue_type_script_setup_true_lang-Bw9j5WbD.js";const ne={class:"max-w-6xl"},re={class:"space-y-6 lg:grid lg:grid-cols-[1fr_360px] lg:gap-8 lg:space-y-0 lg:items-start"},ie={class:"space-y-6"},le={class:"flex gap-1 bg-surface-100 p-1 rounded-lg w-fit"},de=["onClick"],ue={class:"bg-white rounded-xl border border-surface-100 shadow-sm divide-y divide-surface-50"},ce={key:0,class:"px-5 py-10 text-center text-sm text-surface-400"},me={key:0,class:"text-surface-300 shrink-0",title:"System category (read-only)"},fe=["onKeydown"],pe={key:0,class:"text-base leading-none shrink-0"},ye={class:"flex-1 text-sm text-surface-800"},ge={class:"lg:sticky lg:top-6"},ve={class:"bg-white rounded-xl border border-surface-100 shadow-sm p-5"},xe={class:"text-sm font-semibold text-surface-700 mb-3"},$e=q({__name:"CategoriesPage",setup(_e){const v=U(),{confirm:M}=W(),i=H(),c=x("expense"),S=Q(()=>v.categories.filter(a=>a.type===c.value)),_=x(null),l=x(""),k=x(!1);function B(a){_.value=a.id,l.value=a.name}function h(){_.value=null,l.value=""}async function $(a){if(l.value.trim()){k.value=!0;try{await v.updateCategory(a.id,{name:l.value.trim()}),i.success("Category updated"),h()}catch(s){i.error(b(s))}finally{k.value=!1}}}async function F(a){if(await M({title:"Delete Category",message:`Delete "${a.name}"? This may affect existing transactions.`,confirmLabel:"Delete",danger:!0}))try{await v.deleteCategory(a.id),i.success("Category deleted")}catch(e){i.error(b(e))}}const j=X(Z({name:ee().min(1,"Name is required").max(50)})),{handleSubmit:A,isSubmitting:I,resetForm:K}=se({validationSchema:j}),{value:C,errorMessage:L}=te("name"),z=A(async a=>{try{await v.createCategory({name:a.name,type:c.value}),i.success("Category created"),K()}catch(s){i.error(b(s))}});return(a,s)=>(o(),D(ae,null,{default:u(()=>[t("div",ne,[t("div",re,[t("div",ie,[s[7]||(s[7]=t("div",null,[t("h2",{class:"text-base font-semibold text-surface-900"},"Categories"),t("p",{class:"text-xs text-surface-400 mt-0.5"}," System categories are read-only. You can add and manage your own. ")],-1)),t("div",le,[(o(),n(f,null,E(["expense","income"],e=>t("button",{key:e,class:J(["px-4 py-1.5 text-sm font-medium rounded-md transition-colors capitalize",c.value===e?"bg-white shadow text-surface-900":"text-surface-500 hover:text-surface-700"]),onClick:d=>c.value=e},m(e),11,de)),64))]),t("div",ue,[S.value.length===0?(o(),n("div",ce," No categories yet. ")):p("",!0),(o(!0),n(f,null,E(S.value,e=>(o(),n("div",{key:e.id,class:"flex items-center gap-3 px-4 py-3"},[e.is_default?(o(),n("span",me,[...s[3]||(s[3]=[t("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"1.8"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})],-1)])])):p("",!0),_.value===e.id?(o(),n(f,{key:1},[P(t("input",{"onUpdate:modelValue":s[0]||(s[0]=d=>l.value=d),class:"flex-1 rounded-lg border border-primary-400 px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",onKeydown:[N(d=>$(e),["enter"]),N(h,["escape"])]},null,40,fe),[[R,l.value]]),r(w,{size:"sm",loading:k.value,onClick:d=>$(e)},{default:u(()=>[...s[4]||(s[4]=[y("Save",-1)])]),_:1},8,["loading","onClick"]),r(w,{size:"sm",variant:"ghost",onClick:h},{default:u(()=>[...s[5]||(s[5]=[y("Cancel",-1)])]),_:1})],64)):(o(),n(f,{key:2},[e.icon?(o(),n("span",pe,m(e.icon),1)):e.color?(o(),n("span",{key:1,class:"h-3 w-3 rounded-full shrink-0",style:Y({backgroundColor:e.color})},null,4)):p("",!0),t("span",ye,m(e.name),1),r(V,{variant:e.type==="income"?"income":"expense",size:"sm"},{default:u(()=>[y(m(e.type),1)]),_:2},1032,["variant"]),e.is_default?(o(),D(V,{key:2,variant:"system",size:"sm"},{default:u(()=>[...s[6]||(s[6]=[y("System",-1)])]),_:1})):p("",!0),e.is_default?p("",!0):(o(),n(f,{key:3},[r(T,{icon:"edit",title:"Edit",onClick:d=>B(e)},null,8,["onClick"]),r(T,{icon:"delete",title:"Delete",onClick:d=>F(e)},null,8,["onClick"])],64))],64))]))),128))])]),t("div",ge,[t("div",ve,[t("h3",xe," Add "+m(c.value==="income"?"Income":"Expense")+" Category ",1),t("form",{class:"space-y-3",onSubmit:s[2]||(s[2]=G((...e)=>g(z)&&g(z)(...e),["prevent"]))},[r(oe,{modelValue:g(C),"onUpdate:modelValue":s[1]||(s[1]=e=>O(C)?C.value=e:null),placeholder:"Category name",error:g(L)},null,8,["modelValue","error"]),r(w,{class:"w-full",type:"submit",loading:g(I)},{default:u(()=>[...s[8]||(s[8]=[y("Add Category",-1)])]),_:1},8,["loading"])],32)])])])])]),_:1}))}});export{$e as default};
